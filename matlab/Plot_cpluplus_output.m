%% Plot output c++ -- C_0: 
C_0 = [ 8.33828 8.28193 7.97201 7.63481 7.32399 7.03629 6.76804 6.51763 6.2844 6.06833 5.86988 5.68982 5.52927 5.38951 5.27198 5.1782 5.10981 5.06844 5.05576 5.07341 5.12306 5.20635 5.3249 5.48039 5.67451 5.90902 6.18578 6.50677 6.87424 7.29064 7.75907 8.28488 8.29012 8.2939 8.30146 8.31553 8.33465 8.34899 8.36111 8.37591 8.39271 8.39903 8.40928 8.42614 8.43292 8.43898 8.44605 8.45154 8.45353 8.45314 8.44982 8.44629 8.44227 8.43824 8.42475 8.40759 8.39818 8.39063 8.38196 8.37042 8.35428 8.37685 8.3936 8.40709 8.41195 8.40539 8.4022 8.3984 8.40014 8.40678 8.41019 8.40508 8.37493 8.37042 8.35194 6.22431 6.17378 6.19527 6.26781 7.97042 7.92738 7.89437 8.03373 7.88208 8.12775 7.85186 7.82565 8.05727 7.78685 8.04839 7.76187 7.7608 7.80926 7.85641 7.48833 7.8845 7.2117 7.91731 6.93741 7.94353 6.67924 7.96617 6.43779 7.98685 6.21278 7.99661 6.00484 7.99507 5.81446 8.0065 5.64276 8.02665 5.49104 8.02293 5.36067 8.01178 5.25319 8.01674 5.17023 8.01313 5.11344 8.01379 5.0845 8.02774 5.08509 8.01818 5.11686 7.98701 5.18144 7.98534 5.28047 8.04432 5.41557 7.94287 5.5884 7.93402 5.80064 7.9956 6.05407 7.89646 6.35061 7.86768 6.69929 7.87005 7.09132 7.83544 7.51288 7.8442 7.91815 7.74195 7.6776 7.58293 7.49535 7.45753 7.81717 7.40924 7.35442 7.29924 7.24732 7.19964 7.22159 7.31313 7.38812 7.46261 7.442 7.14737 7.49027 6.89839 7.54757 6.64891 7.57965 6.42565 7.58869 6.19873 7.61654 5.99715 7.62628 5.81306 7.62924 5.64824 7.70814 5.5036 7.62891 5.38081 7.63555 5.28159 7.65245 5.20764 7.65359 5.1607 7.65398 5.14249 7.71988 5.15466 7.63674 5.19886 7.62211 5.27671 7.65726 5.38979 5.5397 7.61207 5.72802 7.5842 5.95641 6.23186 7.50649 6.54184 7.47451 6.92046 7.51033 7.35136 7.76311 7.39158 7.18774 7.12699 7.05179 6.98517 6.88523 6.83574 6.78127 6.66284 6.80106 6.90009 6.98108 7.04933 7.11064 6.90118 7.23199 6.73467 7.18968 6.4603 7.22333 6.26417 7.31778 6.06764 7.26359 5.86917 6.13682 5.70841 7.30852 5.56828 7.27948 5.45085 7.29357 5.35766 7.3573 5.29053 7.29434 5.2515 7.33501 5.24208 5.26393 7.27979 5.31872 7.27437 5.40801 7.33237 5.53329 5.69604 7.23578 5.89774 7.20655 6.1499 6.44543 7.1387 6.74452 7.1073 6.74555 6.58988 6.438 6.49591 6.35421 6.35717 6.46728 6.53822 6.62748 6.6926 6.80934 6.8354 6.92515 6.16949 6.93701 5.99092 6.96788 5.83033 5.68263 5.56777 6.9771 5.48152 5.41575 6.98045 5.38282 6.98388 5.38018 5.40978 6.9558 5.47354 6.96836 5.57265 5.70844 5.88219 6.905 6.10825 6.90952 6.38208 6.7498 6.94547 5.84422 6.10134 6.28909 6.29135 6.36804 6.45013 6.53718 6.58647 6.64147 5.97975 5.74807 6.66442 5.63838 5.56959 6.74123 5.5505 6.69022 5.55592 5.58907 6.65437 5.66041 6.6245 5.76817 5.91312 6.10507 6.62436 6.34393 6.69416 6.59966 5.9581 6.02642 6.06113 6.22011 6.25122 6.33173 6.46941 5.77861 5.76098 5.7632 5.7997 6.35948 5.86921 5.98544 6.14512 6.42966 6.37192 5.7808 6.40692 5.97119 6.0192 6.01477 6.10456 0.125773 0.182992 0.167897 0.207966 0.246324 0.282792 0.317583 0.350767 0.382306 0.412098 0.439995 0.465819 0.489353 0.510367 0.528616 0.543846 0.555805 0.564239 0.568906 0.56957 0.566003 0.557983 0.545295 0.527722 0.505044 0.477031 0.44344 0.404012 0.358447 0.306425 0.247712 0.179093 0.175905 0.172104 0.166012 0.156809 0.145875 0.136744 0.128589 0.119698 0.111011 0.105354 0.0984436 0.0901583 0.0851303 0.0809495 0.0769204 0.0739145 0.0726653 0.0729692 0.0747543 0.0771241 0.0800252 0.0838373 0.091261 0.100539 0.107729 0.113622 0.119417 0.125719 0.130336 0.122938 0.113991 0.106288 0.102215 0.102368 0.102777 0.103044 0.101428 0.0982194 0.0965989 0.0986414 0.107562 0.11265 0.119566 0.416995 0.406141 0.415016 0.40598 0.156058 0.162875 0.1684 0.14764 0.17092 0.137058 0.175796 0.180723 0.150298 0.188673 0.156072 0.196023 0.200962 0.198336 0.191762 0.224834 0.185336 0.259643 0.177344 0.295012 0.16991 0.329005 0.162398 0.361429 0.154867 0.392223 0.149721 0.421209 0.14719 0.448257 0.14354 0.473143 0.139269 0.495636 0.13939 0.515497 0.141489 0.532471 0.141941 0.546298 0.144536 0.556722 0.147073 0.563493 0.148275 0.566371 0.153906 0.565125 0.162854 0.559532 0.167553 0.549376 0.163917 0.534444 0.183652 0.514524 0.190899 0.489394 0.188114 0.458824 0.207615 0.422558 0.218484 0.3794 0.223931 0.330429 0.232513 0.277548 0.234119 0.226579 0.193707 0.195484 0.207681 0.219848 0.225924 0.178767 0.233385 0.241922 0.250965 0.260356 0.270017 0.270987 0.262004 0.252534 0.225827 0.243886 0.266607 0.234999 0.299426 0.224244 0.332822 0.216565 0.363262 0.212412 0.394673 0.205777 0.423085 0.202303 0.449493 0.200622 0.47361 0.187972 0.495263 0.200132 0.514171 0.199831 0.53006 0.198638 0.542667 0.20053 0.551728 0.203159 0.556998 0.196358 0.558243 0.212017 0.555238 0.218578 0.547769 0.219141 0.535627 0.518609 0.232443 0.49651 0.243628 0.469115 0.435505 0.261725 0.397316 0.272154 0.349919 0.271862 0.295523 0.188886 0.233589 0.260403 0.268987 0.279876 0.289947 0.304643 0.312927 0.322715 0.341504 0.326911 0.316146 0.306049 0.296203 0.286385 0.298847 0.267581 0.321608 0.271783 0.359256 0.265081 0.386822 0.249549 0.414746 0.256483 0.443284 0.414987 0.466965 0.248968 0.488059 0.253713 0.506246 0.252666 0.521277 0.244512 0.532874 0.256139 0.540752 0.253619 0.544695 0.544476 0.266205 0.539876 0.271611 0.53069 0.268296 0.516728 0.497803 0.28723 0.473727 0.297524 0.442985 0.406471 0.312836 0.369535 0.32259 0.321136 0.343011 0.364888 0.359096 0.379925 0.384109 0.372144 0.364332 0.353182 0.344217 0.327086 0.321925 0.307665 0.402601 0.305124 0.42859 0.300548 0.452264 0.474351 0.492097 0.301863 0.506032 0.517261 0.304388 0.524108 0.307552 0.526896 0.525375 0.315844 0.519308 0.31957 0.50854 0.492907 0.472248 0.334561 0.444658 0.339262 0.41072 0.364726 0.304827 0.454471 0.421766 0.398161 0.398705 0.388607 0.377023 0.364282 0.356935 0.349036 0.434113 0.469512 0.350018 0.486226 0.497619 0.341443 0.502212 0.352129 0.503507 0.501229 0.361193 0.493799 0.3703 0.481544 0.464362 0.440958 0.37575 0.41114 0.341865 0.357266 0.44295 0.435176 0.431394 0.409502 0.405446 0.39437 0.381355 0.469989 0.47382 0.475266 0.472145 0.404384 0.464772 0.451067 0.43149 0.380912 0.392804 0.468237 0.393687 0.444989 0.439519 0.442103 0.431494 ];


C_0_plot = 100 * C_0 * R_g * T / p_atm;
format = '%.2f m';  % used in plots
figure(1); clf;
subplot(221); hold on;
pdeplot(model,'XYData',C_0_plot(1:length(nodes)),'Contour','on','ColorMap','jet');
xlim([0 max(x)]); ylim([0 0.12]); title('Start: O_2 concentration (c++)');
xtickformat(format); ytickformat(format);
c = colorbar; c.Ruler.TickLabelFormat = '%g%%';

subplot(223);
pdeplot(model,'XYData',C_0_plot(1:length(nodes)),'ZData',C_0_plot(1:length(nodes)),'ColorMap','jet');

subplot(222); hold on;
pdeplot(model,'XYData',C_0_plot(length(nodes)+1:end),'Contour','on','ColorMap','jet');
xlim([0 max(x)]); ylim([0 0.12]); title('Start: CO_2 concentration (c++)');
xtickformat(format); ytickformat(format);
c = colorbar; c.Ruler.TickLabelFormat = '%g%%';

subplot(224);
pdeplot(model,'XYData',C_0_plot(length(nodes)+1:end),'ZData',C_0_plot(length(nodes)+1:end),'ColorMap','jet');



%% Plot output C++: -- nonlinear result: 
C_nonlin = [ 6.08502 6.35274 2.24539 0.573554 0.198371 0.157028 0.161651 0.172158 0.182324 0.191142 0.198667 0.205159 0.210805 0.215698 0.219871 0.223315 0.225998 0.227874 0.228883 0.228951 0.227983 0.225855 0.222391 0.217341 0.21039 0.201349 0.191184 0.187435 0.235417 0.626785 2.34494 6.33754 6.32879 6.3173 6.31368 6.30275 6.39423 6.48113 6.49911 6.58779 6.79747 6.79407 6.85211 7.04314 7.1234 7.18149 7.26158 7.33869 7.36722 7.36793 7.32264 7.28075 7.23954 7.19831 7.05024 6.91425 6.88719 6.87007 6.86039 6.8191 6.77012 6.99316 7.10521 7.17418 7.17728 7.08117 7.01488 6.96365 6.95459 6.97643 6.97362 6.94265 6.42392 6.44879 6.41849 0.191691 0.186423 0.193327 0.190671 1.71088 1.56659 1.45525 2.10477 1.45018 3.03791 1.31743 1.27831 2.49723 1.24485 2.59982 1.32719 1.49784 1.77133 1.83296 0.23501 1.75292 0.145528 1.69783 0.151108 1.58975 0.163677 1.43733 0.175247 1.26954 0.18518 1.08868 0.193555 0.894167 0.200699 0.855007 0.206872 0.928897 0.212231 0.846789 0.216845 0.766335 0.22073 0.895093 0.223865 0.999622 0.226211 1.16176 0.227717 1.4922 0.228317 1.64421 0.227929 1.61782 0.226448 1.80209 0.223726 2.57104 0.219549 1.86945 0.213601 2.02102 0.205458 2.79367 0.194742 2.20397 0.182202 2.34152 0.178936 2.60949 0.3 2.50145 1.14278 2.6334 3.29848 0.806193 0.345099 0.222352 0.168163 0.174699 0.788371 0.158048 0.133205 0.123152 0.125362 0.125131 0.165108 0.255974 0.278805 0.155239 0.250618 0.140647 0.2319 0.152135 0.225085 0.164583 0.177098 0.175391 0.1243 0.185483 0.111909 0.193727 0.0863075 0.200765 0.0657058 0.2068 0.131566 0.212018 0.0608219 0.216467 0.0747397 0.220152 0.095938 0.223049 0.119981 0.225116 0.151594 0.226297 0.331671 0.226523 0.227316 0.225705 0.282919 0.223721 0.444532 0.2204 0.215485 0.534052 0.208608 0.596495 0.199338 0.187372 0.637656 0.176485 0.713955 0.202732 0.970189 0.566961 0.700346 0.148493 0.132334 0.135097 0.1401 0.145279 0.15047 0.152911 0.155962 0.158541 0.146059 0.147514 0.148876 0.145378 0.141597 0.150435 0.146251 0.159389 0.143742 0.173192 0.142037 0.182245 0.137582 0.190766 0.143346 0.198688 0.188819 0.204846 0.13757 0.210109 0.143106 0.214518 0.141771 0.218105 0.136203 0.220847 0.138107 0.222693 0.132736 0.223596 0.223485 0.139959 0.22226 0.143186 0.219782 0.179018 0.215849 0.210156 0.163822 0.202295 0.200057 0.191493 0.17893 0.226696 0.175321 0.245804 0.157853 0.16582 0.173257 0.170078 0.177529 0.178351 0.173306 0.171198 0.168638 0.166947 0.162028 0.162166 0.157706 0.186072 0.157451 0.193903 0.155878 0.200593 0.206473 0.211017 0.15577 0.214531 0.217305 0.155904 0.218984 0.155786 0.21966 0.219245 0.156315 0.217621 0.156406 0.214637 0.210051 0.203499 0.160458 0.193973 0.167922 0.181256 0.165637 0.157279 0.200969 0.191322 0.183898 0.185128 0.183346 0.180965 0.178159 0.176645 0.174412 0.195061 0.205263 0.173114 0.209804 0.212771 0.168589 0.214042 0.170286 0.214429 0.21382 0.171225 0.211785 0.17164 0.208248 0.202929 0.195073 0.171792 0.184325 0.171801 0.176738 0.198234 0.196748 0.196637 0.191162 0.190638 0.187934 0.181426 0.206222 0.207505 0.207987 0.207145 0.184597 0.204938 0.200708 0.194235 0.184101 0.186217 0.205382 0.183443 0.20063 0.19955 0.199939 0.19666 3.30001 4.33548 4.42355 5.31671 6.081 6.7829 7.43803 8.05144 8.6257 9.16168 9.65892 10.1159 10.5303 10.899 11.2186 11.4854 11.6954 11.8448 11.9292 11.9447 11.8869 11.7515 11.5336 11.2281 10.8293 10.3304 9.72343 8.99906 8.14568 7.14076 5.90076 4.25457 4.20084 4.1383 4.03024 3.85689 3.62745 3.43154 3.26322 3.06035 2.84366 2.71876 2.5553 2.34313 2.21371 2.10695 2.00154 1.91989 1.88459 1.89024 1.93597 1.99578 2.06728 2.16018 2.34361 2.56205 2.71672 2.83593 2.94866 3.07429 3.15904 2.96604 2.75522 2.58407 2.50348 2.52891 2.56041 2.58593 2.56521 2.50561 2.48169 2.54293 2.81994 2.95434 3.11165 9.30772 9.00606 9.26682 9.10905 4.09506 4.22548 4.32704 3.91692 4.35897 3.65903 4.44935 4.53643 4.00995 4.69062 4.14791 4.83446 4.93557 4.88767 4.77192 5.65748 4.6623 6.33464 4.51631 7.00895 4.38048 7.64482 4.23952 8.24122 4.09126 8.80013 3.98953 9.32052 3.94356 9.80219 3.86505 10.2426 3.76773 10.6389 3.77724 10.988 3.83251 11.286 3.84185 11.5291 3.90148 11.7133 3.95695 11.8345 3.97311 11.8885 4.09553 11.8713 4.29499 11.7784 4.38784 11.6053 4.2669 11.3474 4.72807 10.9991 4.86565 10.5544 4.75234 10.0061 5.1816 9.34554 5.3773 8.5461 5.45118 7.61956 5.6131 6.56108 5.62433 5.4212 5.01808 5.01359 5.24089 5.46815 5.56823 4.67649 5.70102 5.8575 6.02518 6.20248 6.39148 6.41494 6.24868 6.07988 5.66063 5.92852 6.45215 5.76825 7.07774 5.56634 7.70163 5.42393 8.26211 5.34994 8.83349 5.21987 9.3452 5.15387 9.81729 5.12421 10.2459 4.85664 10.6293 5.12241 10.9635 5.12022 11.2445 5.0976 11.468 5.14004 11.63 5.19702 11.7263 5.0509 11.7528 5.38374 11.7054 5.51779 11.5798 5.52636 11.3714 11.0755 5.78625 10.6865 5.99988 10.198 9.59007 6.33852 8.88757 6.52164 8.0013 6.48635 6.95248 4.91527 5.78756 6.30406 6.44767 6.64285 6.82295 7.09636 7.24566 7.42602 7.78632 7.51103 7.31711 7.13985 6.96771 6.79424 7.0473 6.43833 7.46937 6.53518 8.17063 6.41438 8.67441 6.11275 9.18215 6.26068 9.6971 9.17487 10.1218 6.11992 10.499 6.22004 10.8237 6.20164 11.0925 6.03849 11.3008 6.27362 11.4442 6.22479 11.5188 11.5208 6.47345 11.4459 6.57883 11.29 6.50877 11.0486 10.717 6.87243 10.2897 7.05719 9.73665 9.06921 7.33251 8.38072 7.49863 7.44062 7.84743 8.25061 8.12863 8.51712 8.59637 8.37942 8.24484 8.05001 7.89797 7.59428 7.51351 7.25567 8.94774 7.21867 9.4226 7.13761 9.85336 10.2535 10.5748 7.1714 10.8282 11.0331 7.21941 11.1606 7.27936 11.2167 11.1968 7.43479 11.0962 7.49963 10.9116 10.6389 10.2735 7.77039 9.77904 7.84455 9.16135 8.30824 7.22549 9.89787 9.30912 8.88413 8.90854 8.7398 8.5414 8.31932 8.1939 8.05499 9.52317 10.1767 8.08472 10.4838 10.6946 7.92274 10.7851 8.12064 10.8164 10.7836 8.28424 10.6584 8.4435 10.4459 10.1428 9.72409 8.52962 9.18301 7.92555 8.21878 9.70791 9.58271 9.53116 9.14488 9.0817 8.88892 8.66241 10.2138 10.2927 10.328 10.2802 9.07172 10.1543 9.91311 9.5631 8.64924 8.87209 10.1711 8.88416 9.78705 9.70098 9.75326 9.56752 ];


C_0_plot = 100 * C_nonlin * R_g * T / p_atm;
format = '%.2f m';  % used in plots
figure(2); clf; 
subplot(221); hold on;
pdeplot(model,'XYData',C_0_plot(1:length(nodes)),'Contour','on','ColorMap','jet');
xlim([0 max(x)]); ylim([0 0.12]); title('Nonlin: O_2 concentration (c++)');
xtickformat(format); ytickformat(format);
c = colorbar; c.Ruler.TickLabelFormat = '%g%%';

subplot(223);
pdeplot(model,'XYData',C_0_plot(1:length(nodes)),'ZData',C_0_plot(1:length(nodes)),'ColorMap','jet');

subplot(222); hold on;
pdeplot(model,'XYData',C_0_plot(length(nodes)+1:end),'Contour','on','ColorMap','jet');
xlim([0 max(x)]); ylim([0 0.12]); title('Nonlin: CO_2 concentration (c++)');
xtickformat(format); ytickformat(format);
c = colorbar; c.Ruler.TickLabelFormat = '%g%%';

subplot(224);
pdeplot(model,'XYData',C_0_plot(length(nodes)+1:end),'ZData',C_0_plot(length(nodes)+1:end),'ColorMap','jet');